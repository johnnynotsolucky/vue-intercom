!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?module.exports=factory():"function"==typeof define&&define.amd?define(factory):global.VueIntercom=factory()}(this,function(){"use strict";var Vue,installed,callIf=function(a,f){return a&&f()},assert=function(condition,msg){return callIf(!condition,function(){throw new Error("[vue-intercom] "+msg)})},is=function(t,o){return o instanceof t||null!==o&&void 0!==o&&o.constructor===t},mapInstanceToProps=function(vm,props){var o={};return props.forEach(function(p){return o[p]={get:function(){return vm[p]}}}),o},init=function(ref){var appId=ref.appId;assert(Vue,"call Vue.use(VueIntercom) before creating an instance");var vm=new Vue({data:function(){return{ready:!1,visible:!1,unreadCount:0}}}),callIntercom=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return window.Intercom.apply(window,args)},intercom={_vm:vm};return Object.defineProperties(intercom,mapInstanceToProps(vm,["ready","visible","unreadCount"])),intercom._call=callIntercom,intercom._init=function(){vm.ready=!0,callIntercom("onHide",function(){return vm.visible=!1}),callIntercom("onShow",function(){return vm.visible=!0}),callIntercom("onUnreadCountChange",function(unreadCount){return vm.unreadCount=unreadCount})},intercom.boot=function(options){void 0===options&&(options={app_id:appId}),callIf(!options.app_id,function(){return options.app_id=appId}),callIntercom("boot",options)},intercom.shutdown=function(){return callIntercom("shutdown")},intercom.update=function(){for(var options=[],len=arguments.length;len--;)options[len]=arguments[len];return callIntercom.apply(void 0,["update"].concat(options))},intercom.show=function(){return callIntercom("show")},intercom.hide=function(){return callIntercom("hide")},intercom.showMessages=function(){return callIntercom("showMessages")},intercom.showNewMessage=function(content){return callIntercom.apply(void 0,["showNewMessage"].concat(is(String,content)?[content]:[]))},intercom.trackEvent=function(name){for(var metadata=[],len=arguments.length-1;len-- >0;)metadata[len]=arguments[len+1];return callIntercom.apply(void 0,["trackEvent"].concat([name].concat(metadata)))},intercom.getVisitorId=function(){return callIntercom("getVisitorId")},intercom};return init.install=function(_Vue,ref){var appId=ref.appId;assert(!Vue,"already installed."),Vue=_Vue;var vueIntercom=init({appId:appId});Vue.mixin({mounted:function(){var this$1=this;callIf(!installed,function(){if("function"==typeof window.Intercom)this$1.$intercom._init(),this$1.$intercom._call("reattach_activator"),this$1.$intercom.update();else{var placeholder=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];return placeholder.c(args)};placeholder.q=[],placeholder.c=function(args){return placeholder.q.push(args)},window.Intercom=placeholder;var loaded=function(){return init.loadScript(appId,function(){return this$1.$intercom._init()})};"complete"===document.readyState?loaded():window.attachEvent?window.attachEvent("onload",loaded):window.addEventListener("load",loaded,!1)}installed=!0})}}),Object.defineProperty(Vue.prototype,"$intercom",{get:function(){return vueIntercom}})},init.loadScript=function(appId,done){var script=document.createElement("script");script.async=!0,script.src="https://widget.intercom.io/widget/"+appId;var firstScript=document.getElementsByTagName("script")[0];firstScript.parentNode.insertBefore(script,firstScript),script.onload=done},init});